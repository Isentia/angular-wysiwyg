!function(e,t){"use strict";var a=[["bold","italic","underline","strikethrough","subscript","superscript"],["format-block"],["font"],["font-size"],["font-color","hilite-color"],["remove-format"],["ordered-list","unordered-list","outdent","indent"],["left-justify","center-justify","right-justify"],["code","quote","paragraph"],["link","image"]];e.module("wysiwyg.module",["colorpicker.module"]).directive("wysiwyg",["$timeout","wysiwgGui","$compile",function(a,n,i){function l(l,s,u,o){function r(){c(),d(),f(),m()}function c(){n.setCustomElements(l.textareaCustomMenu);var e=s.children("div.wysiwyg-menu")[0];e.appendChild(n.createMenu(l.textareaMenu)),i(e)(l)}function d(){l.$watch("textareaDisabled",function(t){var a=e.element("div.wysiwyg-menu");a.find("button").prop("disabled",t),a.find("select").prop("disabled",t)})}function f(){"true"===u.enableBootstrapTitle&&u.enableBootstrapTitle!==t&&s.find("button[title]").tooltip({container:"body"})}function m(){function n(e){var t=e||"";return t=t.replace(/[\u2018|\u2019|\u201A]/g,"'"),t=t.replace(/[\u201C|\u201D|\u201E]/g,'"'),t=t.replace(/\u2026/g,"..."),t=t.replace(/[\u2013|\u2014]/g,"-"),t=t.replace(/\u02C6/g,"^"),t=t.replace(/\u2039/g,""),t=t.replace(/[\u02DC|\u00A0]/g," ")}function i(e){if(/<body[^]*\/body>/i.test(e)){var t=e.match(/<body[^]*\/body>/gi);t&&t.length>0&&(e="",t.forEach(function(t){e+=t+"\n"}))}return e=e.replace(/<style[^]*\/style>/gi,""),e=e.replace(/<head[^]*\/head>/gi,""),e=e.replace(/<meta[^]*\/meta>/gi,""),e=e.replace(/<!--[^]+?-->/gi,""),e=e.replace(/(<.+?)(\s[^>]*)?>/gi,"$1>"),e=e.replace(/(&shy;)/gi," "),e=e.replace(/(&nbsp;)/gi," "),e=e.replace(/\r?\n/gi," "),e=e.replace(/<p>/gi,"<br>"),e=e.replace(/<li ?\/? ?>/gi,"<br>"),e=e.replace(/<\/?(font|a|span|input|body|ul|li|p) ?\/?>/gi,""),e=e.replace(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/gi,""),e=e.replace(/<(?!br)(?:[^>=]|='[^']*'|="[^"]*"|=[^'"][^\s>]*)*>/gi,""),e=e.replace(/<br>(\s<br>)*/gi,"<br>"),e=n(e)}e.element(".wysiwyg-menu").find("button").on("click",function(){var t=e.element(this);l.$emit("wysiwyg.click",t.attr("title")||t.attr("data-original-title"))}),v.on("input keyup paste mouseup",function(){var e=v.html();"<br>"==e&&(e=""),o.$setViewValue(e)}),(l.pastePlainText===!0||"true"==l.pastePlainText)&&v.on("paste",function(e){if(e.originalEvent.clipboardData===t)return setTimeout(function(){var e=i(o.$viewValue);o.$setViewValue(e),o.$render()},250),void(e.returnValue=!1);var a=e.originalEvent.clipboardData.getData("text/plain"),n=e.originalEvent.clipboardData.getData("text/html");n&&(e.preventDefault(),"custom"==l.pastePlainTextMode?(n=i(n),document.execCommand("insertHTML",!1,n)):document.execCommand("insertHTML",!1,a))}),v.on("keydown",function(e){if(9==e.keyCode){{var t=(v.html(),window.getSelection());t.anchorOffset}e.preventDefault()}}),v.on("click keyup focus mouseup",function(){a(function(){l.isBold=l.cmdState("bold"),l.isUnderlined=l.cmdState("underline"),l.isStrikethrough=l.cmdState("strikethrough"),l.isItalic=l.cmdState("italic"),l.isSuperscript=g("SUP"),l.isSubscript=g("SUB"),l.isRightJustified=l.cmdState("justifyright"),l.isLeftJustified=l.cmdState("justifyleft"),l.isCenterJustified=l.cmdState("justifycenter"),l.isPre="pre"===l.cmdValue("formatblock"),l.isBlockquote="blockquote"===l.cmdValue("formatblock"),l.isOrderedList=l.cmdState("insertorderedlist"),l.isUnorderedList=l.cmdState("insertunorderedlist"),l.fonts.forEach(function(e){return l.cmdValue("fontname").indexOf(e)>-1?(l.font=e,!1):void 0}),l.cmdValue("formatblock").toLowerCase(),l.formatBlocks.forEach(function(e){return l.cmdValue("formatblock").toLowerCase()===e.value.toLowerCase()?(l.formatBlock=e,!1):void 0}),l.fontSizes.forEach(function(e){return l.cmdValue("fontsize")===e.value?(l.fontSize=e,!1):void 0}),l.hiliteColor=b(),s.find("button.wysiwyg-hiliteColor").css("background-color",l.hiliteColor),l.fontColor=l.cmdValue("forecolor"),s.find("button.wysiwyg-fontcolor").css("color",l.fontColor),l.isLink=g("A")},0)})}function g(e){var t=window.getSelection().getRangeAt(0);return t&&(t.startContainer.parentNode.tagName===e.toUpperCase()||t.endContainer.parentNode.tagName===e.toUpperCase())?!0:!1}function b(){var t=window.getSelection().getRangeAt(0);if(t){var a=e.element(t.startContainer.parentNode).attr("style");if(!e.isDefined(a))return!1;for(var n=a.split(";"),i=0;i<n.length;i++){var l=n[i].split(":");if("background-color"===l[0])return l[1]}return"#fff"}return"#fff"}var v=s.find("div.wysiwyg-textarea");l.isLink=!1,l.fontSizes=[{value:"1",size:"10px"},{value:"2",size:"13px"},{value:"3",size:"16px"},{value:"4",size:"18px"},{value:"5",size:"24px"},{value:"6",size:"32px"},{value:"7",size:"48px"}],l.formatBlocks=[{name:"Heading Blocks",value:"div"},{name:"Heading 1",value:"h1"},{name:"Heading 2",value:"h2"},{name:"Heading 3",value:"h3"},{name:"Heading 4",value:"h4"},{name:"Heading 5",value:"h5"},{name:"Heading 6",value:"h6"}],l.formatBlock=l.formatBlocks[0],l.fontSize=l.fontSizes[1],e.isArray(l.cssClasses)&&(l.cssClasses.unshift("css"),l.cssClass=l.cssClasses[0]),l.fonts=["Georgia","Palatino Linotype","Times New Roman","Arial","Helvetica","Arial Black","Comic Sans MS","Impact","Lucida Sans Unicode","Tahoma","Trebuchet MS","Verdana","Courier New","Lucida Console","Helvetica Neue"].sort(),l.font=l.fonts[6],r(),o.$render=function(){v.html(o.$viewValue)},l.format=function(e,t){document.execCommand(e,!1,t)},l.cmdState=function(e){return document.queryCommandState(e)},l.cmdValue=function(e){return document.queryCommandValue(e)},l.createLink=function(){var e=prompt("Enter the link URL");e&&e!==t&&l.format("createlink",e)},l.insertImage=function(){var e=prompt("Enter the image URL");e&&e!==t&&l.format("insertimage",e)},l.setFont=function(){l.format("fontname",l.font)},l.setFontSize=function(){l.format("fontsize",l.fontSize.value)},l.setFormatBlock=function(){l.format("formatBlock",l.formatBlock.value)},l.setFontColor=function(){l.format("forecolor",l.fontColor)},l.setHiliteColor=function(){l.format("hiliteColor",l.hiliteColor)},l.enableObjResizing=l.enableObjResizing===t?!0:l.enableObjResizing,l.format("enableobjectresizing",l.enableObjResizing),l.styleWithCss=l.styleWithCss===t?!0:l.styleWithCss,l.format("styleWithCSS",l.styleWithCss)}return{template:'<div><style>   .wysiwyg-textarea[contentEditable="false"] { background-color:#eee}   .wysiwyg-btn-group-margin { margin-right:5px; }   .wysiwyg-select { height:30px;margin-bottom:1px;}   .wysiwyg-colorpicker { font-family: arial, sans-serif !important;}</style><div class="wysiwyg-menu"></div><div id="{{textareaId}}" ng-attr-style="resize:vertical;height:{{textareaHeight || \'80px\'}}; overflow:auto" contentEditable="{{!textareaDisabled}}" class="{{textareaClass}} wysiwyg-textarea" rows="{{textareaRows}}" name="{{textareaName}}" required="{{textareaRequired}}" placeholder="{{textareaPlaceholder}}" ng-model="value"></div></div>',restrict:"E",scope:{value:"=ngModel",textareaHeight:"@textareaHeight",textareaName:"@textareaName",textareaClass:"@textareaClass",textareaRequired:"@textareaRequired",textareaId:"@textareaId",textareaMenu:"=textareaMenu",textareaCustomMenu:"=textareaCustomMenu",pastePlainText:"=pastePlainText",pastePlainTextMode:"@pastePlainTextMode",fn:"&",textareaDisabled:"=?textareaDisabled",styleWithCss:"=",enableObjResizing:"="},replace:!0,require:"ngModel",link:l,transclude:!0}}]).factory("wysiwgGui",["wysiwgGuiElements",function(t){function n(e){var t;if(e.tag)t=document.createElement(e.tag);else{if(!e.text)return console.log("cannot create this element."),t=document.createElement("span");t=document.createElement("span")}if(e.text&&document.all?t.innerText=e.text:e.text&&(t.textContent=e.text),e.classes&&(t.className=e.classes),e.html&&(t.innerHTML=e.html),e.attributes&&e.attributes.length)for(var a in e.attributes){var i=e.attributes[a];i.name&&i.value&&t.setAttribute(i.name,i.value)}if(e.data&&e.data.length)for(var l in e.data)t.appendChild(n(e.data[l]));return t}var i=t,l={},s=function(e){l=e},u=function(){return{tag:"div",classes:"btn-group btn-group-sm wysiwyg-btn-group-margin"}},o=function(e){return i[e]||{}},r=function(t){e.extend(i,l),t=e.isDefined(t)&&""!==t?t:a;for(var s,r=document.createElement("div"),c=0;c<t.length;c++){for(var d=n(u()),f=0;f<t[c].length;f++)"link"===t[c][f]&&(s=n(o("unlink")),d.appendChild(s)),s=n(o(t[c][f])),d.appendChild(s);r.appendChild(d)}return r};return{createMenu:r,setCustomElements:s}}]).value("wysiwgGuiElements",{bold:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Bold"},{name:"ng-click",value:"format('bold')"},{name:"ng-class",value:"{ active: isBold }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-bold"}]},italic:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Italic"},{name:"ng-click",value:"format('italic')"},{name:"ng-class",value:"{ active: isItalic }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-italic"}]},underline:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Underline"},{name:"ng-click",value:"format('underline')"},{name:"ng-class",value:"{ active: isUnderlined }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-underline"}]},strikethrough:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Strikethrough"},{name:"ng-click",value:"format('strikethrough')"},{name:"ng-class",value:"{ active: isStrikethrough }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-strikethrough"}]},subscript:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Subscript"},{name:"ng-click",value:"format('subscript')"},{name:"ng-class",value:"{ active: isSubscript }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-subscript"}]},superscript:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Superscript"},{name:"ng-click",value:"format('superscript')"},{name:"ng-class",value:"{ active: isSuperscript }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-superscript"}]},"remove-format":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Remove Formatting"},{name:"ng-click",value:"format('removeFormat')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-eraser"}]},"ordered-list":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Ordered List"},{name:"ng-click",value:"format('insertorderedlist')"},{name:"ng-class",value:"{ active: isOrderedList }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-list-ol"}]},"unordered-list":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Unordered List"},{name:"ng-click",value:"format('insertunorderedlist')"},{name:"ng-class",value:"{ active: isUnorderedList }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-list-ul"}]},outdent:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Outdent"},{name:"ng-click",value:"format('outdent')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-outdent"}]},indent:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Indent"},{name:"ng-click",value:"format('indent')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-indent"}]},"left-justify":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Left Justify"},{name:"ng-click",value:"format('justifyleft')"},{name:"ng-class",value:"{ active: isLeftJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-left"}]},"center-justify":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Center Justify"},{name:"ng-click",value:"format('justifycenter')"},{name:"ng-class",value:"{ active: isCenterJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-center"}]},"right-justify":{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Right Justify"},{name:"ng-click",value:"format('justifyright')"},{name:"ng-class",value:"{ active: isRightJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-right"}]},code:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Code"},{name:"ng-click",value:"format('formatblock', 'pre')"},{name:"ng-class",value:"{ active: isPre }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-code"}]},quote:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Quote"},{name:"ng-click",value:"format('formatblock', 'blockquote')"},{name:"ng-class",value:"{ active: isBlockquote }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-quote-right"}]},paragraph:{tag:"button",classes:"btn wysiwyq-btn-default",text:"P",attributes:[{name:"title",value:"Paragragh"},{name:"ng-click",value:"format('insertParagraph')"},{name:"ng-class",value:"{ active: isParagraph }"},{name:"type",value:"button"}]},image:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Image"},{name:"ng-click",value:"insertImage()"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-picture-o"}]},"font-color":{tag:"button",classes:"btn wysiwyq-btn-default wysiwyg-colorpicker wysiwyg-fontcolor",text:"A",attributes:[{name:"title",value:"Font Colour"},{name:"colorpicker",value:"rgba"},{name:"colorpicker-position",value:"top"},{name:"ng-model",value:"fontColor"},{name:"ng-change",value:"setFontColor()"},{name:"type",value:"button"}]},"hilite-color":{tag:"button",classes:"btn wysiwyq-btn-default wysiwyg-colorpicker wysiwyg-fontcolor",text:"H",attributes:[{name:"title",value:"Highlight Colour"},{name:"colorpicker",value:"rgba"},{name:"colorpicker-position",value:"top"},{name:"ng-model",value:"hiliteColor"},{name:"ng-change",value:"setHiliteColor()"},{name:"type",value:"button"}]},font:{tag:"select",classes:"form-control mp-font-select",attributes:[{name:"title",value:"Image"},{name:"ng-model",value:"font"},{name:"ng-options",value:"f for f in fonts"},{name:"ng-change",value:"setFont()"}]},"font-size":{tag:"select",classes:"form-control mp-size-select",attributes:[{name:"title",value:"Image"},{name:"ng-model",value:"fontSize"},{name:"ng-options",value:"f.size for f in fontSizes"},{name:"ng-change",value:"setFontSize()"}]},"format-block":{tag:"select",classes:"form-control wysiwyg-select",attributes:[{name:"title",value:"Format Block"},{name:"ng-model",value:"formatBlock"},{name:"ng-options",value:"f.name for f in formatBlocks"},{name:"ng-change",value:"setFormatBlock()"}]},link:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Link"},{name:"ng-click",value:"createLink()"},{name:"ng-show",value:"!isLink"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-link"}]},unlink:{tag:"button",classes:"btn wysiwyq-btn-default",attributes:[{name:"title",value:"Unlink"},{name:"ng-click",value:"format('unlink')"},{name:"ng-show",value:"isLink"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-unlink"}]}})}(angular);